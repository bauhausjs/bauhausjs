

<script type="text/ng-template" id="tree-item">
    <div href="#/page/{{data._id}}" class="page-tree-item-link clickable" ng-click="changePage(data._id)" ng-init="data.open = store.isExpanded(data) ? true : false" ng-class="{ open: data.open === true, selected: data._id === store.current.pageId }">
        <div class="page-tree-item-collapse clickable" ng-click="store.toggle(data)" ng-class="{ visible: store.hasChildren(data) === true }" prevent-default>
            <i class="page-tree-collapse-icon fa fa-caret-right"></i>
        </div>
        <div class="page-tree-item-title" title="{{data.title}}"><i class="fa fa-file-o"></i> &nbsp;{{data.title}}</div>
        <div class="page-tree-item-add clickable" ng-click="newPage(data)" prevent-default><i class="fa fa-plus"></i></div>
    </div>
    <ul ng-show="data.open" class="page-tree">
        <li class="page-tree-item" ng-repeat="data in data.children" ng-include="'tree-item'"></li>
    </ul>
</script>

<ul class="page-tree root">
    <li class="page-tree-item" ng-repeat="data in store.tree" ng-include="'tree-item'"></li>
</ul>

<div class="page-editor">
    <div class="page-editor-header">

        <div class="page-editor-status">
            <div ng-switch="pageHasChanges">
                <span ng-switch-when="true">Page has changes, please save</span>
                <span ng-switch-default>Page up to date</span>
            </div>
            <div ng-switch="contentHasChanges.length === 0">
                <span ng-switch-when="true">Content up to date</span>
                <span ng-switch-default>Content has changes {{contentHasChanges}}</span>
            </div>

            <input type="submit" class="button" value="Save" ng-click="updatePage(page)" /><br /><br />
        </div>

        <div class="page-editor-header-title">
            <i class="fa fa-file-o"></i> <input type="text" class="title" ng-model="page.title" />
            <div class="page-editor-header-show-label clickable" ng-click="showPageLabel = true" ng-show="!showPageLabel">Add seperate  label for navigation</div>
        </div>
        <div class="page-editor-header-label" ng-show="showPageLabel">
            <i class="fa fa-sitemap"></i> Label <input type="text" class="label" ng-model="page.label" />
        </div>
        <div class="page-editor-header-route">
            <i class="fa fa-globe"></i> Route <input type="text" class="route" ng-model="page.route" />
        </div>
        
        

    </div>

    <div class="page-editor-tabs">
        <ul class="tabs">
            <li class="tabs-item" ng-repeat="slot in currentPageType.slots" ng-class="{ selected: tab === ('slot:' + slot.name) }">    
                <div class="tabs-item-button clickable" ng-click="$parent.tab = 'slot:' + slot.name"><i class="fa fa-file-text-o"></i> {{ slot.label }}</div>
            </li>

            <li class="tabs-item" ng-class="{ selected: tab === 'layout' }">    
                <div class="tabs-item-button clickable" ng-click="tab = 'layout'"><i class="fa fa-columns"></i> Layout</div>
            </li>

            <li class="tabs-item delete right">    
                <div class="tabs-item-button clickable" ng-click="deletePage(page)">Delete</div>
            </li>
        </ul>
    </div>


    <!--div class="page-slot-content-add">
        <select ng-options="name as type.title for (name, type) in contentTypes" ng-model="newContentType"></select>    
    </div-->

    <div class="page-editor-container page-slots" ng-repeat="slot in currentPageType.slots" ng-show="tab === 'slot:' + slot.name">
        <div class="page-slot">
            <div class="page-content" ng-repeat="content in slots[$index]">
                <div class="page-content-type"><i class="fa fa-puzzle-piece"></i> {{ contentTypes[content._type].title }}</div>
                <div bauhaus-form ng-model="content" config="contentTypes[content._type]"></div>  
            </div>
        </div>
    </div>

    <div class="page-editor-container page-layout" ng-show="tab === 'layout'">
        <i class="fa fa-columns"></i> Page Type: <select ng-model="page._type" ng-options="name as type.title for (name, type) in pageTypes"></select> 
    </div>
</div>
